# Websocket

## 1. 获取websocket节点

> http-get ```/api/websocket/end_point```

##### 1.1 请求参数说明
```
公共参数
```

##### 1.2 响应参数说明
```
{
    error_code
    error_reason
    end_point:ws://ctest.yueyuewo.cn:9999
    ping_interval:心跳包时间间隔
}
```


## 2. Websocket通信细节

### 2.1 长连接断开情况
```
客户端15秒发一次心跳包 服务端20秒未收到心跳包则长连接为断开(如网络异常)
客户端杀掉进程 长连接直接断开
```

### 2.2 网络重新连接处理
```
用户网络重连后获取一次用户基本信息,如果发现用户的current_room_id为空则表示用已被踢出房间，
此时客户端应让用户退出声网的房间(无需调用服务端退出房间接口)
```

### 2.3 杀掉进程处理
```
杀掉进程后服务端会把用户直接踢出房间
```

### 2.4 断线通知
```
用户A断线后服务端会把用户A直接踢出房间,并通知此房间的另一位用户B,由用户B通过信令通知房间的其他用户
用户A已退出房间;用户B完成通知后需上报服务器已通知(防止用户B也出现异常)
```